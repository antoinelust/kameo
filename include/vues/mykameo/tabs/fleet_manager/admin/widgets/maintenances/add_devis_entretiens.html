<div class="modal fade" id="addDevis" tabindex="-1" role="modal" aria-labelledby="modal-label" aria-hidden="true" style="display: none; overflow-y: auto !important; z-index: 10000;">
	<div class="modal-dialog modal-lg">
		<div class="modal-content">
			<div class="modal-header">
				<button type="button" class="close" data-dismiss="modal" aria-hidden="true">×</button>
			</div>
			<div class="modal-body">
				<div class="row">
					<div class="col-md-12">
						<h4 class="text-green">Ajouter un Devis</h4>
						<form name="widget-addDevis-form" id="widget-addDevis-form" action="apis/Kameo/add_devis.php" role="form" method="post">
							<div class="form-group col-md-12">
								<h4 class="text-green">Informations générales</h4>
								<div class="col-md-12">
									<div class="col-md-4">
										<label for="widget-addDevis-form-company">Originateur</label>
										<select class="widget-addDevis-form-company" name="company"></select>
									</div>
									<div class="col-md-4">
										<label for="beneficiaryCompany">Beneficiaire</label>
										<input type="text" name="beneficiaryCompany" class="form-control required" readonly='readonly' value="KAMEO">
									</div>
								</div>
								<div class="col-md-12">
									<div class="col-md-4">
										<label for="communication">Communication</label>
										<input type="text" name="communication" class="form-control" readonly='readonly'>
									</div>
								</div>
								<div class="separator"></div>
								<h4 class="text-green">Informations sur les dates</h4>
								<div class="col-md-12">
									<div class="col-md-6">
										<label for="widget-addDevis-form-date">Date de devis</label>
										<input type="date" class="widget-addDevis-form-date form-control required" name="widget-addDevis-form-date">
									</div>
								</div>
								<div class="separator"></div>
								<div class="col-md-12 generateBillDetails">
									<div class="row generateBillAccessoriesDevis">
										<div class="col-md-12">
											<h4 class="text-green">Accessoires catalogue: </h4>
										</div>
										<div class="col-md-12 accessoriesButtons">
											<i class="fa fa-calculator"></i> <span class="accessoriesNumber">0</span><input type="hidden" id="accessoriesNumber" name="accessoriesNumber" value="0" />
											<button class="button small green button-3d rounded icon-right glyphicon glyphicon-plus" type="button"></button>
											<button class="button small red button-3d rounded icon-right glyphicon glyphicon-minus" style="display: none;" type="button"></button>
										</div>
										<table class="table table-condensed tableFixed otherCostsAccesoiresTable hideAt0" style="display: none;">
											<thead>
												<th class="accessoriesLabel"></th>
												<th class="accessoriesCategory">
													<label for="aCategory">Catégorie</label>
												</th>
												<th class="accessoriesAccessory">
													<label for="aAccessory">Accessoire</label>
												</th>
												<th class="accessoriesBuyingPrice">
													<label for="aBuyingPrice">Prix achat</label>
												</th>
												<th class="accessoriesPriceHTVA">
													<label for="aPriceHTVA">Prix Vente HTVA</label>
												</th>
											</thead>
											<tbody>
											</tbody>
										</table>
									</div>
									<div class="separator"></div>
									<div class="row generateBillOtherAccessoriesDevis">
										<div class="col-md-12">
											<h4 class="text-green">Accessoires autre : </h4>
										</div>
										<div class="col-md-12 accessoriesButtons">
											<i class="fa fa-calculator"></i>
											<span class="otherAccessoriesNumber">0</span>
											<input type="hidden" id="otherAccessoriesNumber" name="otherAccessoriesNumber" value="0" />
											<button class="button small green button-3d rounded icon-right glyphicon glyphicon-plus" type="button"></button>
											<button class="button small red button-3d rounded icon-right glyphicon glyphicon-minus" style="display: none;" type="button"></button>
										</div>
										<table class="table table-condensed tableFixed otherCostsOtherAccesoiresTable hideAt0" style="display: none;">
											<thead>
												<th class="otherAccessoriesLabel"></th>
												<th class="accessoriesAccessory">
													<label for="aAccessory">Accessoire</label>
												</th>
												<th class="accessoriesPriceHTVA">
													<label for="aPriceHTVA">Prix Vente HTVA</label>
												</th>
											</thead>
											<tbody>
											</tbody>
										</table>
									</div>
									<div class="separator"></div>

									<div class="row generateBillManualWorkloadDevis">
										<div class="col-md-12">
											<h4 class="text-green">Main d'oeuvre : </h4>
										</div>
										<div class="col-md-12">
											<i class="fa fa-calculator"></i>
											<span class="manualWorkloadNumber">0</span>
											<input type="hidden" id="manualWorkloadNumber" name="manualWorkloadNumber" value="0" />
											<button class="button small green button-3d rounded icon-right glyphicon glyphicon-plus" type="button"></button>
											<button class="button small red button-3d rounded icon-right glyphicon glyphicon-minus" style="display: none;" type="button"></button>
										</div>
										<table class="table table-condensed tableFixed otherCostsManualWorkloadTable hideAt0" style="display: none;">
											<thead>
												<th class="col-md-2">Catégorie</th>
												<th class="col-md-2">Description</th>
												<th class="col-md-2">Vélo</th>
												<th class="col-md-2">Durée (min)</th>
												<th class="col-md-2">Total (€ HTVA)</th>
												<th class="col-md-2">Total (€ TVAC)</th>
											</thead>
											<tbody>
											</tbody>
										</table>
									</div>
								</div>
								<div class="separator"></div>
								<div class="col-md-12">
									<h4 class="text-green">Commentaires à mentionner dans la devis : </h4>
								</div>
								<div class="col-md-12">
									<textarea name="commentDevis" rows="5" cols="33" class="form-control"></textarea>
								</div>
							</div>
							<input type="text" name="communicationHidden" class="hidden">
							<input type="text" class="widget-addDevis-form-email" name="widget-addDevis-form-email" value="<?php echo $user_data['EMAIL']; ?>" hidden>
							<div class="separator"></div>
							<div class="col-md-12">
								<button  class="button small green button-3d rounded icon-left" type="submit"><i class="fa fa-plus"></i><?= L::generic_confirm ?></button>
							</div>
						</form>
					</div>
				</div>
			</div>
			<div class="modal-footer">
				<button type="button" class="btn btn-b" data-dismiss="modal"><?= L::generic_close; ?></button>
			</div>
		</div>
	</div>
</div>
<script type="text/javascript">
	jQuery("#widget-addDevis-form").validate({
		submitHandler: function(form) {
			jQuery(form).ajaxSubmit({
				success: function(response) {
					if (response.response == 'success') {
						$.notify({
							message: response.message
						}, {
							type: 'success'
						});
						
						$('#addDevis').modal('toggle');
						document.getElementById('widget-addDevis-form').reset();
						$("#listDevisDone").dataTable().api().ajax.reload();
						$("#listDevisNone").dataTable().api().ajax.reload();
					} else {
						$.notify({
							message: response.message
						}, {
							type: 'danger'
						});
					}
				}
			});
		}
	});
</script>