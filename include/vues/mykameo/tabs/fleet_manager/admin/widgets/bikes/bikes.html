<div
  class="modal fade"
  id="BikesListingAdmin"
  tabindex="9"
  role="modal"
  aria-labelledby="modal-label"
  aria-hidden="true"
  style="display: none; overflow-y: auto !important"
>
  <div class="modal-dialog modal-lg" style="width: 85%">
    <div class="modal-content">
      <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal" aria-hidden="true">×</button>
      </div>
      <div data-example-id="contextual-table" class="bs-example">
        <h4 class="text-green">Vélos: Leasing et autres</h4>
        <a class="button small green button-3d rounded icon-right addBikeAdmin" data-target="#bikeManagement" data-toggle="modal" href="#">
        <i class="fa fa-plus"></i> Ajouter un vélo
        </a>
        <span class="button small green button-3d rounded icon-right showSoldBikes">
        <span>Afficher les vélos vendus</span>
        </span>
        <span class="button small green button-3d rounded icon-right showOrders">
        <span>Afficher les commandes</span>
        </span>
        <span class="button small green button-3d rounded icon-right showStockBikes">
        <span">Afficher les vélos en stock</span>
        </span>
        <span class="button small green button-3d rounded icon-right showPendingDeliveryBike">
          <span">Afficher les vélos en attente de livraison</span>
        </span>
        <span class="button small green button-3d rounded icon-right showStolenBikes">
          <span">Afficher les vélos volés</span>
        </span>
        <span class="button small green button-3d rounded icon-right linkBikesToBills">Liason factures - vélos</span>
        <table class="table table-condensed" id="bikesListingTable" data-order='[[ 0, "desc" ]]' data-page-length='25'>
          <div id="load" style="display: block; width: 100%; height: 100%;">
          <div class="center col-md-4"><img src="../images/Gif_Kameo.gif" alt=""></div></div>
        </table>
        <table id='linkBikesToBills' class='table' style='width: 100%''></table><div class='separator'></div><h4 class='text-green'>Vélos encore à lier</h4><table id='bikesNotLinkedTable' class='table' style='width: 100%''></table>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-b" data-dismiss="modal"><?= L::generic_close; ?></button>
      </div>
    </div>
  </div>
</div>



<div class="modal fade" id="linkBikesToBillsManagement" tabindex="-1" role="modal" aria-labelledby="modal-label" aria-hidden="true" style="display: none;">
	<div class="modal-dialog modal-lg">
		<div class="modal-content">
			<div class="modal-header">
				<button type="button" class="close" data-dismiss="modal" aria-hidden="true">×</button>
			</div>
			<div class="modal-body">
				<div class="row">
					<div class="col-sm-12">
						<h4 class="text-green">Gérer les vélos de la facture</h4>
						<form id="widget-linkBikesToBills-form" action="apis/Kameo/portfolioBikes/portfolioBikes.php" role="form" method="post">
							<div class="form-group col-md-12">
								<h4 class="text-green">Informations générales</h4>
								<div class="col-md-4">
									<label for="ID">ID</label>
									<input type="number" name="ID" class="form-control" readonly>
								</div>
								<div class="col-md-4">
									<label for="supplier">Fournisseur</label>
									<input type="text" name="supplier" class="form-control required" disabled>
								</div>
								<div class="col-md-4">
									<label for="communication">Communication</label>
									<input type="text" name="communication" class="form-control" disabled>
								</div>
								<div class="col-md-4">
									<label for="date">Date</label>
									<input type="date" class="form-control required" name="date" disabled>
								</div>
                <div class="separator"></div>
                <div class="form-group col-md-12">
                  <h4 class="text-green">Résumé: </h4>
                  <table id='summaryBikesLinked' class='table' style='width: 100%'></table>
                </div>
                <div class="separator"></div>
                <div class="col-sm-12">
                  <h4 class="text-green">Facture (PDF)</h4>
                  <object data="" class="PDFFile" type="application/pdf" width="100%" height="800px">
                    <p>Apparemment vous n'avez pas un plug-in pour lire directement un fichier PDF.</p>
                  </object>
                </div>

								<div class="separator"></div>
								<div class="col-md-12" id='linkBikesToBillsTable'>
									<div class="row">
										<h4 class="text-green">Liaison entre vélo et facture: </h4>
										<div class="col-sm-12">
											<i class="fa fa-bicycle"></i> <span class="bikesNumber">0</span><input type="hidden" name="bikesNumber" value="0" />
											<button class="button small green button-3d rounded icon-right glyphicon glyphicon-plus" type="button"></button>
											<button class="button small red button-3d rounded icon-right glyphicon glyphicon-minus" style="display: none;" type="button"></button>
										</div>
										<table class="table table-condensed tableFixed bikeNumberTable">
											<thead>
												<tr>
                          <th class="bLabel">
                            <label for="bLabel">N°</label>
                          </th>
                          <th class="brand">
                            <label for="brand">Marque</label>
                          </th>
                          <th class="model">
                            <label for="model">Modèle</label>
                          </th>
													<th class="catalogID">
														<label for="catalogID">ID catalogue</label>
													</th>
                          <th class="size">
                            <label for="size">Size</label>
                          </th>
													<th class="pCatalog">
														<label for="pCatalog">Prix d'achat</label>
													</th>
                          <th class="pVenteHTVA">
														<label for="pVenteHTVA">Prix de vente catalogue</label>
													</th>
                          <th class="pVenteHTVA">
														<label for="pVenteHTVA">Identification du vélo</label>
													</th>
												</tr>
											</thead>
											<tbody></tbody>
										</table>
									</div>
								</div>
							</div>
              <input type="text" class="widget-addBill-form-email" name="widget-addBill-form-email" value="<?php echo $user_data['EMAIL']; ?>" hidden>
              <input type="text" name="action" value="linkBikeToBill" hidden>
							<div class="separator"></div>
							<div class="col-md-12">
								<button  class="button small green button-3d rounded icon-left" type="submit"><i class="fa fa-plus"></i><?= L::generic_send; ?></button>
							</div>
						</form>
            <div class="space"></div>
            <div class="form-group col-md-12">
              <h4 class="text-green">Vélos non liés: </h4>
              <div class="col-md-12">
                <select class='form-control' name='bikesNotLinked'></select>
              </div>
              <table id='bikesNotLinkedSelection' class='table' style='width: 100%'></table>
            </div>
					</div>
				</div>
			</div>
			<div class="modal-footer">
				<button type="button" class="btn btn-b" data-dismiss="modal"><?= L::generic_close; ?></button>
			</div>
			</div>
		</div>
	</div>
</div>
<script type="text/javascript">
	jQuery("#widget-linkBikesToBills-form").validate({
		submitHandler: function(form) {
			jQuery(form).ajaxSubmit({
				success: function(response) {
					if (response.response == 'success') {
						$.notify({
							message: response.message
						},{
							type: 'success'
						});
            $("#summaryBikesLinked").dataTable().api().ajax.reload();
            getListOfBikesBill($('#widget-linkBikesToBills-form input[name=ID]').val());
					} else {
						$.notify({
							message: response.message
						}, {
							type: 'danger'
						});
					}
				}
			});
		}
	});
</script>
