<div
  class="modal fade"
  id="ordersListing"
  tabindex="9"
  role="modal"
  aria-labelledby="modal-label"
  aria-hidden="true"
  style="display: none; overflow-y: auto !important"
>
  <div class="modal-dialog modal-lg">
    <div class="modal-content">
      <div class="modal-header">
        <button
          type="button"
          class="close"
          data-dismiss="modal"
          aria-hidden="true"
        >
          ×
        </button>
      </div>
      <h4 class="text-green">Gérer les vélos commandables</h4>
      <div class="table-responsive">
        <table
          id="companiesOrderable"
          class="table"
          style="width: 100%"
        ></table>
      </div>
      <script>
        $(".ordersManagerClick").click(function () {
          $("#companiesOrderable").dataTable({
            destroy: true,
            ajax: {
              url: "apis/Kameo/companies/companies.php",
              contentType: "application/json",
              type: "GET",
              data: {
                action: "listCafetariaCompanies",
              },
            },
            sAjaxDataProp: "",
            columnDefs: [{ width: "100%", targets: 0 }],
            columns: [
              {
                title: "Name",
                data: "COMPANY_NAME",
                fnCreatedCell: function (nTd, sData, oData, iRow, iCol) {
                  var cafetaria = oData.CAFETARIA === "Y" ? true : false;
                  var discount = oData.DISCOUNT;
                  var tva = oData.TVA_INCLUDED === "Y" ? true : false;
                  var type = oData.CAFETERIA_TYPE;
                  var types = oData.CAFETERIA_TYPES;
                  $(nTd).html(
                    "<a href='#' data-target='#manageOrderable' data-toggle='modal' data-cafetaria='" +
                      cafetaria +
                      "'data-discount='" +
                      discount +
                      "'data-tva='" +
                      tva +
                      "'data-types='" +
                      types +
                      "'data-type='" +
                      type +
                      "' data-company='" +
                      sData +
                      "'>" +
                      sData +
                      "</a>"
                  );
                },
              },
              { title: "Bikes", data: "NUM_OF_ORDERABLE" },
              { title: "Cafetaria", data: "CAFETARIA" },
            ],
            order: [
              [2, "desc"],
              [0, "asc"],
            ],
          });
        });
      </script>
      <div class="separator"></div>
      <h4 class="text-green">Gérer les commandes</h4>
      <a class="button small green button-3d rounded icon-right addOrder" data-target="#orderManager" data-toggle="modal" href="#">
        <span><i class="fa fa-plus"></i> Ajouter une commande</span>
      </a>
      <br>
      <div data-example-id="contextual-table" class="bs-example">
        <span id="ordersListingSpan"></span>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-b" data-dismiss="modal">
          <?= L::generic_close; ?>
        </button>
      </div>
    </div>
  </div>
</div>
<script type="text/javascript">
  $(".form_date_start_client").datetimepicker({
    language: "fr",
    weekStart: 1,
    todayBtn: 1,
    autoclose: 1,
    todayHighlight: 1,
    startView: 2,
    minView: 2,
    forceParse: 0,
  });
  $(".form_date_end_client").datetimepicker({
    language: "fr",
    weekStart: 1,
    todayBtn: 1,
    autoclose: 1,
    todayHighlight: 1,
    startView: 2,
    minView: 2,
    forceParse: 0,
  });
  $(".form_date_start_client").change(function () {
    generateCompaniesGraphic(
      $(".form_date_start_client").data("datetimepicker").getDate(),
      $(".form_date_end_client").data("datetimepicker").getDate()
    );
  });
  $(".form_date_end_client").change(function () {
    generateCompaniesGraphic(
      $(".form_date_start_client").data("datetimepicker").getDate(),
      $(".form_date_end_client").data("datetimepicker").getDate()
    );
  });
</script>
