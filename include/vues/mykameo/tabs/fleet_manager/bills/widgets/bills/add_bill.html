<div class="modal fade" id="addBill" tabindex="-1" role="modal" aria-labelledby="modal-label" aria-hidden="true" style="display: none; overflow-y: auto !important; z-index: 10000;">
	<div class="modal-dialog modal-lg">
		<div class="modal-content">
			<div class="modal-header">
				<button type="button" class="close" data-dismiss="modal" aria-hidden="true">×</button>
			</div>
			<div class="modal-body">
				<div class="row">
					<div class="col-md-12">
						<h4 class="text-green">Ajouter une facture</h4>
						<form name="widget-addBill-form" id="widget-addBill-form" action="apis/Kameo/add_bill.php" role="form" method="post">
							<div class="form-group col-md-12">
								<h4 class="text-green">Informations générales</h4>
								<div class="col-md-12">
									<div class="col-md-4 IDAddBill hidden">
										<label for="ID">ID</label>
										<input type="number" name="ID" class="form-control" readonly='readonly'>
									</div>
									<div class="col-md-4 IDAddBillOut hidden">
										<label for="ID_OUT">ID OUT</label>
										<input type="number" name="ID_OUT" class="form-control" readonly='readonly'>
									</div>
								</div>
								<div class="col-md-12">
									<div class="col-md-4">
										<label for="widget-addBill-form-company">Originateur</label>
										<select class="widget-addBill-form-company" name="company"></select>
									</div>
									<div class="col-md-4">
										<label for="beneficiaryCompany">Beneficiaire</label>
										<input type="text" name="beneficiaryCompany" class="form-control required" readonly='readonly' value="KAMEO">
									</div>
									<div class="col-md-4">
										<label for="type">Type de facture</label>
										<select name="type">
											<option value="leasing">Location</option>
											<option value="achat">Achat</option>
											<option value="accessoire">Accessoire</option>
											<option value="credit">Note de crédit</option>
											<option value="autre">Autre</option>
										</select>
									</div>
								</div>
								<div class="col-md-12">
									<div class="col-md-4 widget-addBill-form-companyOther">
										<label for="widget-addBill-form-companyOther" class="widget-addBill-form-companyOther">Informations complémentaires (Origi.)</label>
										<input type="text" class="form-control widget-addBill-form-companyOther" name="widget-addBill-form-companyOther">
									</div>
									<div class="col-md-4"></div>
									<div class="col-md-4 typeOther">
										<label for="typeOther" class="hidden">Informations complémentaires (type)</label>
										<input type="text" class="form-control hidden" name="typeOther">
									</div>
								</div>
								<div class="col-md-12">
									<div class="col-md-4">
										<label for="communication">Communication</label>
										<input type="text" name="communication" class="form-control" readonly='readonly'>
									</div>
								</div>
								<div class="separator"></div>
								<h4 class="text-green">Informations sur les dates</h4>
								<div class="col-md-12">
									<div class="col-md-6">
										<label for="widget-addBill-form-date">Date</label>
										<input type="date" class="widget-addBill-form-date form-control required" name="widget-addBill-form-date">
									</div>
									<div class="col-md-6">
										<label for="widget-addBill-form-datelimite">Date limite de paiement</label>
										<input type="date" class="widget-addBill-form-datelimite form-control required" name="widget-addBill-form-datelimite">
									</div>
								</div>
								<div class="col-md-12">
									<div class="col-md-6">
										<label for="widget-addBill-form-sent">Envoyée ?</label>
										<input type="checkbox" name="widget-addBill-form-sent" >
									</div>
									<div class="col-md-6">
										<label for="widget-addBill-form-sendingDate">Date d'envoi</label>
										<input type="date" class="widget-addBill-form-sendingDate form-control" name="widget-addBill-form-sendingDate">
									</div>
								</div>
								<div class="col-md-12">
									<div class="col-md-6">
										<label for="widget-addBill-form-paid"">Payée ?</label>
										<input type="checkbox" name="widget-addBill-form-paid" >
									</div>
									<div class="col-md-6">
										<label for="widget-addBill-form-paymentDate">Date de paiement</label>
										<input type="date" class="widget-addBill-form-paymentDate form-control " name="widget-addBill-form-paymentDate" >
									</div>
								</div>
								<div class="separator"></div>
								<div class="col-md-12">
									<div class="col-md-4">
										<label for="billType">Type de facture</label>
										<select name="billType">
											<option value="automatic">Generation automatique</option>
											<option value="manual">Import manuel</option>
										</select>
									</div>
								</div>
								<div class="separator"></div>
								<div class="col-md-12 generateBillDetails">
									<div class="row generateBillBike">
										<div class="col-md-12">
											<h4 class="text-green">Nombre de vélos: </h4>
										</div>
										<div class="col-md-12">
											<i class="fa fa-bicycle"></i> <span class="bikesNumber">0</span><input type="hidden" id="bikesNumberBill" name="bikesNumber" value="0" />
											<button class="button small green button-3d rounded icon-right glyphicon glyphicon-plus" type="button"></button>
											<button class="button small red button-3d rounded icon-right glyphicon glyphicon-minus" style="display: none;" type="button"></button>
										</div>
										<table class="table table-condensed tableFixed bikeNumberTable hideAt0" style="display: none;">
											<thead>
												<tr>
													<th class="bLabel"></th>
													<th class="bikeBrandModel">
														<label for="bikeID">Vélo</label>
													</th>
													<th class="bikepAchat">
														<label for="pAchat">Prix d'achat</label>
													</th>
													<th class="bikepCatalog">
														<label for="pCatalog">Prix catalogue</label>
													</th>
													<th class="bikepVenteHTVA">
														<label for="pVenteHTVA">Prix de vente</label>
													</th>
													<th class="bikeMarge">
														<label for="marge">Marge</label>
													</th>
													<th class="hidden">
													</th>
												</tr>
											</thead>
											<tbody></tbody>
										</table>
									</div>
									<div class="separator"></div>
									<div class="row generateBillAccessories">
										<div class="col-md-12">
											<h4 class="text-green">Accessoires catalogue: </h4>
										</div>
										<div class="col-md-12 accessoriesButtons">
											<i class="fa fa-calculator"></i> <span class="accessoriesNumber">0</span><input type="hidden" id="accessoriesNumber" name="accessoriesNumber" value="0" />
											<button class="button small green button-3d rounded icon-right glyphicon glyphicon-plus" type="button"></button>
											<button class="button small red button-3d rounded icon-right glyphicon glyphicon-minus" style="display: none;" type="button"></button>
										</div>
										<table class="table table-condensed tableFixed otherCostsAccesoiresTable hideAt0" style="display: none;">
											<thead>
												<th class="accessoriesLabel"></th>
												<th class="accessoriesCategory">
													<label for="aCategory">Catégorie</label>
												</th>
												<th class="accessoriesAccessory">
													<label for="aAccessory"">Accessoire</label>
												</th>
												<th class="accessoriesBuyingPrice">
													<label for="aBuyingPrice">Prix achat</label>
												</th>
												<th class="accessoriesPriceHTVA">
													<label for="aPriceHTVA">Prix Vente HTVA</label>
												</th>
											</thead>
											<tbody>
											</tbody>
										</table>
									</div>
									<div class="separator"></div>
									<div class="row generateBillOtherAccessories">
										<div class="col-md-12">
											<h4 class="text-green">Accessoires autre : </h4>
										</div>
										<div class="col-md-12 accessoriesButtons">
											<i class="fa fa-calculator"></i>
											<span class="otherAccessoriesNumber">0</span>
											<input type="hidden" id="otherAccessoriesNumber" name="otherAccessoriesNumber" value="0" />
											<button class="button small green button-3d rounded icon-right glyphicon glyphicon-plus" type="button"></button>
											<button class="button small red button-3d rounded icon-right glyphicon glyphicon-minus" style="display: none;" type="button"></button>
										</div>
										<table class="table table-condensed tableFixed otherCostsOtherAccesoiresTable hideAt0" style="display: none;">
											<thead>
												<th class="otherAccessoriesLabel"></th>
												<th class="accessoriesAccessory">
													<label for="aAccessory">Accessoire</label>
												</th>
												<th class="accessoriesPriceHTVA">
													<label for="aPriceHTVA">Prix Vente HTVA</label>
												</th>
											</thead>
											<tbody>
											</tbody>
										</table>
									</div>
									<div class="separator"></div>

									<div class="row generateBillManualWorkload">
										<div class="col-md-12">
											<h4 class="text-green">Main d'oeuvre : </h4>
										</div>
										<div class="col-md-12">
											<i class="fa fa-calculator"></i>
											<span class="manualWorkloadNumber">0</span>
											<input type="hidden" id="manualWorkloadNumber" name="manualWorkloadNumber" value="0" />
											<button class="button small green button-3d rounded icon-right glyphicon glyphicon-plus" type="button"></button>
											<button class="button small red button-3d rounded icon-right glyphicon glyphicon-minus" style="display: none;" type="button"></button>
										</div>
										<table class="table table-condensed tableFixed otherCostsManualWorkloadTable hideAt0" style="display: none;">
											<thead>
												<th class="col-md-2">Catégorie</th>
												<th class="col-md-2">Description</th>
												<th class="col-md-2">Vélo</th>
												<th class="col-md-2">Durée (min)</th>
												<th class="col-md-2">Total (€ HTVA)</th>
												<th class="col-md-2">Total (€ TVAC)</th>
											</thead>
											<tbody>
											</tbody>
										</table>
									</div>
								</div>
								<div class="separator"></div>
								<div class="col-md-12">
									<h4 class="text-green">Commentaires à mentionner dans la facture : </h4>
								</div>
								<div class="col-md-12">
									<textarea name="comment" rows="5" cols="33" class="form-control"></textarea>
								</div>
								<h4 class="text-green manualBill" style="display: none;">Informations sur les montants</h4>
								<div class="col-md-12 manualBill" style="display: none;">
									<div class="col-md-4">
										<label for="widget-addBill-form-amountHTVA">Montant (HTVA)</label>
										<input type="text" class="widget-addBill-form-amountHTVA form-control required" name="widget-addBill-form-amountHTVA">
									</div>
									<div class="col-md-4">
										<label for="widget-addBill-form-VAT">TVA ? </label>
										<input type="checkbox" class="widget-addBill-form-VAT form-control" name="widget-addBill-form-VAT" />
									</div>
									<div class="col-md-4">
										<label for="widget-addBill-form-amountTVAC">Montant (TVAC)</label>
										<input type="text" class="widget-addBill-form-amountTVAC form-control required" name="widget-addBill-form-amountTVAC" readonly="readonly">
									</div>
									<div class="form-group col-md-6">
										<label for="widget-addBill-form-file">Facture</label>
										<input type="hidden" name="MAX_FILE_SIZE" value="6291456" />
										<input type=file size=40 id="widget-addBill-form-file" class="form-control required" name="widget-addBill-form-file">
									</div>
								</div>
							</div>
							<input type="text" name="communicationHidden" class="hidden">
							<input type="text" class="widget-addBill-form-email" name="widget-addBill-form-email" value="<?php echo $user_data['EMAIL']; ?>" hidden>
							<div class="separator"></div>
							<div class="col-md-12">
								<button  class="button small green button-3d rounded icon-left" type="submit"><i class="fa fa-plus"></i><?= L::generic_confirm ?></button>
							</div>
						</form>
					</div>
				</div>
			</div>
			<div class="modal-footer">
				<button type="button" class="btn btn-b" data-dismiss="modal"><?= L::generic_close; ?></button>
			</div>
		</div>
	</div>
</div>
<script type="text/javascript">
	jQuery("#widget-addBill-form").validate({
		submitHandler: function(form) {
			jQuery(form).ajaxSubmit({
				success: function(response) {
					if (response.response == 'success') {
						$.notify({
							message: response.message
						}, {
							type: 'success'
						});
						get_bills_listing();
						$('#addBill').modal('toggle');
						document.getElementById('widget-addBill-form').reset();
					} else {
						$.notify({
							message: response.message
						}, {
							type: 'danger'
						});
					}
				}
			});
		}
	});
</script>
