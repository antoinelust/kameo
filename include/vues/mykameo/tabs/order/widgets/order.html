<div
  class="modal fade"
  id="command"
  tabindex="-1"
  role="modal"
  aria-labelledby="modal-label"
  aria-hidden="true"
  style="display: none; overflow-y: auto !important">
>
  <div class="modal-dialog modal-lg">
    <div class="modal-content">
      <div class="modal-header">
        <button
          type="button"
          class="close"
          data-dismiss="modal"
          aria-hidden="true"
        >
          ×
        </button>
      </div>
      <div class="modal-body">
        <div class="row">
          <div class="col-sm-12">
            <form
              id="widget-command-form"
              action="apis/Kameo/command.php"
              role="form"
              method="post"
            >
              <div class="form-group col-sm-12">
                <h4 class="text-green"><?=L::mk_order_title;?></h4>
                <div class="col-sm-12">
                  <div class="col-sm-4 hidden">
                    <label for="ID">ID :</label>
                    <input
                      type="text"
                      readonly="readonly"
                      class="form-control"
                      name="ID"
                    />
                  </div>
                  <div class="col-sm-4">
                    <label for="size"><?=L::mk_order_taille;?></label>
                    <select class="form-control required" name="size">
                      <option value="XS">XS</option>
                      <option value="S">S</option>
                      <option value="M" selected>M</option>
                      <option value="L">L</option>
                      <option value="XL">XL</option>
                    </select>
                  </div>
                  <div class="col-sm-4">
                    <label for="leasing_type"><?=L::mk_order_leasing_type;?></label>
                    <select class="form-control required" name="leasing_type">
                    </select>
                  </div>
                  <div class="col-sm-4">
                    <label for="order_amount"></label>
                    <div class="input-group">
                      <span class="input-group-addon order_amount_order"></span>
                      <input type="number" step="0.01" name="order_amount" class="form-control required" readonly/>
                    </div>

                  </div>
                  <div class="col-sm-12"></div>
                  <div class="col-sm-4">
                    <label for="brand"><?=L::mk_order_brand;?></label>
                    <select class="form-control required" disabled name="brand">
                      <option value="Ahooga">Ahooga</option>
                      <option value="Benno">Benno</option>
                      <option value="Bzen">Bzen</option>
                      <option value="Conway">Conway</option>
                      <option value="Douze cycle">Douze Cycle</option>
                      <option value="HNF Nicolai">HNF Nicolai</option>
                      <option value="Kayza">Kayza</option>
                      <option value="Moustache Bikes">Moustache</option>
                      <option value="Orbea">Orbea</option>
                      <option value="Victoria">Victoria</option>
                      <option value="other">Other</option>
                    </select>
                  </div>
                  <div class="col-sm-4">
                    <label for="model"><?=L::mk_order_model;?></label>
                    <input
                      type="text"
                      class="form-control required"
                      name="model"
                      disabled
                    />
                  </div>
                  <div class="col-sm-4">
                    <label>
                      <span><?=L::mk_order_frame;?></span>
                    </label>
                    <select class="form-control required" disabled name="frame">
                      <option value="F"><?=L::mk_order_woman;?></option>
                      <option value="H"><?=L::mk_order_man;?></option>
                      <option value="M"><?=L::mk_order_mix;?></option>
                    </select>
                  </div>
                  <div class="col-sm-4">
                    <label>
                      <span><?=L::mk_order_usage;?></span>
                    </label>
                    <select class="form-control" name="utilisation" disabled>
                      <option value="Tout chemin">
                        <?=L::mk_order_usage_allway;?>
                      </option>
                      <option value="Ville et chemin">
                        <?=L::mk_order_usage_citypath;?>
                      </option>
                      <option value="Pliant">
                        <?=L::mk_order_usage_pliant;?>
                      </option>
                      <option value="Ville">
                        <?=L::mk_order_usage_city;?>
                      </option>
                      <option value="Cargo">Cargo</option>
                      <option value="Gravel">Gravel</option>
                      <option value="VTT">VTT</option>
                      <option value="Speedpedelec">Speedpedelec</option>
                    </select>
                  </div>
                  <div class="col-sm-4">
                    <label for="electric">
                      <span><?=L::mk_order_electric;?></span>
                    </label>
                    <select
                      class="form-control required"
                      name="electric"
                      disabled
                    >
                      <option value="Y"><?=L::mk_order_elecyes;?></option>
                      <option value="N"><?=L::mk_order_elecno;?></option>
                    </select>
                  </div>
                  <div class="col-sm-4">
                    <label for="retailPriceTVAC"><?= L::mk_order_retail_price_TVAC; ?></label>
                    <div class="input-group">
                      <span class="input-group-addon">€</span>
                      <input type="number" step="0.01" name="retailPriceTVAC" class="form-control required" disabled/>
                    </div>
                  </div>
                </div>
                <div class="separator"></div>
                <h4 class="text-green"><?=L::mk_order_image;?></h4>
                <div class="col-sm-12">
                  <img src="" class="commandImage" alt="image" height="400" />
                </div>
                <label for="remark"><?=L::mk_order_remarks_accessory;?></label>
                <textarea
                  class="form-control"
                  rows="5"
                  name="remark"
                ></textarea>

                <div class="separator"></div>
                <h4 class="text-green"><?= L::mk_order_current_accessories_basket; ?></h4>
                <div id="accessoriesBasket">
                  <p id="accessoriesBasketEmpy"><?= L::mk_order_accessory_basket_empty; ?></p>
                </div>
                <input
                  type="text"
                  name="email"
                  class="form-control hidden"
                  value="<?php echo $user_data['EMAIL']; ?>"
                />
                <input
                  type="text"
                  name="action"
                  class="form-control hidden"
                  value="command"
                />
              </div>
              <div class="separator"></div>
              <div class="text-center"><button id="send" class="button small red button-3d rounded icon-left" type="submit"><i class="fa fa-plus"></i><?=L::mk_order_orderbtn;?></button></div>
              <div class="separator"></div>
              <h4 class="text-green"><?= L::mk_order_catalog_accessory; ?></h4>
              <div class="col-md-4">
                <label for="accessoriesCategories"><?= L::mk_order_accessory_type; ?></label>
                <select name="accessoriesCategories"></select>
              </div>
              <div class="space"></div>
              <div class="text-center loaderOrderPortfolioAccessories">
                <img src='images/loading2.gif'>
              </div>
              <div class="gridForAccessories align-self-stretch"></div>
            </form>
          </div>
        </div>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-b" data-dismiss="modal">
          <?=L::mk_order_close;?>
        </button>
      </div>
    </div>
  </div>
</div>
<script type="text/javascript">
  jQuery("#widget-command-form").validate({
    submitHandler: function (form) {
      jQuery(form).ajaxSubmit({
        success: function (response) {
          if (response.response == "success") {
            $.notify(
              {
                message: response.message,
              },
              {
                type: "success",
              }
            );
            $(".grid").isotope("destroy");
            $(".grid").html("");
            $("#command").modal("toggle");
            get_command_user(email);
          } else {
            $.notify(
              {
                message: response.message,
              },
              {
                type: "danger",
              }
            );
          }
        },
      });
    },
  });
</script>


<div
  class="modal fade"
  id="commandAccessory"
  tabindex="-1"
  role="modal"
  aria-labelledby="modal-label"
  aria-hidden="true"
  style="display: none; overflow-y: auto !important">
  <div class="modal-dialog modal-lg">
    <div class="modal-content">
      <div class="modal-header">
        <button
          type="button"
          class="close"
          data-dismiss="modal"
          aria-hidden="true"
        >
          ×
        </button>
      </div>
      <div class="modal-body">
        <div class="row">
          <div class="col-sm-12">
            <form
              id="widget-commandAccessory-form"
            >
              <div class="form-group col-sm-12">
                <h4 class="text-green"><?=L::mk_order_title_accessory;?></h4>
                <div class="col-sm-12">
                  <h4 class="text-green"><?=L::mk_order_subtitle_accessory;?></h4>
                  <div class="col-sm-4 hidden">
                    <label for="ID">ID :</label>
                    <input
                      type="text"
                      readonly="readonly"
                      class="form-control"
                      name="ID"
                    />
                  </div>
                  <div class="col-sm-4">
                    <label for="category"><?=L::generic_category;?></label>
                    <input
                      type="text"
                      class="form-control required"
                      name="category"
                      disabled
                    />
                  </div>
                  <div class="col-sm-4">
                    <label for="model"><?=L::mk_order_brand;?></label>
                    <input
                      type="text"
                      class="form-control required"
                      name="brand"
                      disabled
                    />
                  </div>
                  <div class="col-sm-4">
                    <label for="model"><?=L::mk_order_model;?></label>
                    <input
                      type="text"
                      class="form-control required"
                      name="model"
                      disabled
                    />
                  </div>
                </div>
                <div class='space'></div>
                <div class="col-sm-12">
                  <h4 class="text-green"><?=L::leasingType_title;?></h4>
                  <span id="orderAccessoryBillingType"></span>
                </div>
                <div class="separator"></div>
                <h4 class="text-green"><?=L::mk_order_image;?></h4>
                <div class="col-sm-6 center">
                  <img src="" class="commandAccessoryImage" alt="image" height="200px" width="auto" />
                </div>
              </div>
              <button class="button small green button-3d rounded icon-left" type="submit"><i class="fa fa-plus"></i ><?=L::generic_add_to_basket;?></button>
            </form>
          </div>
        </div>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-b" data-dismiss="modal">
          <?=L::generic_close;?>
        </button>
      </div>
    </div>
  </div>
</div>
<script type="text/javascript">
  jQuery("#widget-commandAccessory-form").validate({
    submitHandler: function (form) {
      if($("#widget-commandAccessory-form input[name=billingType]:checked").val()=="achat")
        var amount = $("#widget-commandAccessory-form input[name=billingType]:checked").data("amount")+" €";
      else if($("#widget-commandAccessory-form input[name=billingType]:checked").val()=="leasing")
        var amount = $("#widget-commandAccessory-form input[name=billingType]:checked").data("amount")+" €/"+traduction.generic_mois;
      else if($("#widget-commandAccessory-form input[name=billingType]:checked").val()=="annualleasing")
        var amount = $("#widget-commandAccessory-form input[name=billingType]:checked").data("amount")+" €/"+traduction.generic_year;

      $('#accessoriesBasket').append('<div class="col-md-4 accessoryCard d-flex" style="margin-bottom : 10px"><div class="card" style="border: 1px solid black; padding : 18px"><div class="card-body text-center">\
        <h5 class="card-title">'+$('#widget-commandAccessory-form input[name=category]').val()+'</h5>\
        <h6 class="card-subtitle mb-2 text-muted">'+$('#widget-commandAccessory-form input[name=brand]').val()+$('#widget-commandAccessory-form input[name=model]').val()+'</h6>\
        <img src="images_accessories/'+$('#widget-commandAccessory-form input[name=ID]').val()+'.jpg" style="height:100px"/>\
        <br><span>'+traduction.generic_amount+' : '+amount+'</span><br>\
        <input type="text" class="hidden" name="accessory[]" value="'+$("#widget-commandAccessory-form input[name=ID]").val()+'">\
        <input type="text" class="hidden" name="accessoryBillingType[]" value="'+$("#widget-commandAccessory-form input[name=billingType]:checked").val()+'">\
        <input type="text" class="hidden" name="accessoryAmount[]" value="'+$("#widget-commandAccessory-form input[name=billingType]:checked").data("amount")+'">\
        <a href="#" class="text-red deleteAccessoryBasket">'+traduction.generic_delete+'</a>\
        </div></div></div>');
      $('#widget-command-form #accessoriesBasketEmpy').html("");
      $('#commandAccessory').modal("toggle");

      $('.deleteAccessoryBasket').click(function(){
        $(this).closest('.accessoryCard').remove();
        if($('#widget-command-form .accessoryCard').length==0){
          $('#widget-command-form #accessoriesBasketEmpy').html(traduction.mk_order_accessory_basket_empty);
          console.log(traduction.mk_order_accessory_basket_empty);
        }else{
          $('#widget-command-form #accessoriesBasketEmpy').html("");
        }
      })
    }
  });
</script>
